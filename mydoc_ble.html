<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="ble,  ">
<title>Introduction to Bluetooth Low Energy technology | VBLUno51 board</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-orange.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/vbluno2_small.png">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="https://vngiotlab.github.io/vblunofeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });
            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });
            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });
        });
    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
                        
            <img src="images/pic_topnav.png" alt="VBLUno51 board">
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> VBLUno51 - VNG Bluetooth Low Energy UNO nRF51822 - IoT development board</span>            
            
            </a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i></a></li>
                <!-- entries without drop-downs appear here -->
                                                    
                                
                    
                    
                    <li><a href="news">News</a></li>
                    
                    
                                        
                               
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                    
                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                            
                            <li><a href="https://goo.gl/bISeQl" target="_blank">VBLUno51 on Facebook</a></li>
                            
                            
                            
                            <li><a href="https://goo.gl/w8gQHT" target="_blank">VBLUno51 on store</a></li>
                            
                            
                            
                            <li><a href="https://goo.gl/kpLmQs" target="_blank">DAPLink (CMSIS-DAP) interface</a></li>
                            
                            
                            
                            <li><a href="https://goo.gl/1nj0LZ" target="_blank">VBLUno on Arduino.vn forum</a></li>
                            
                            
                        </ul>
                    </li>
                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">SDK & OS Supports<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                            
                            <li><a href="mydoc_getstart_arduino.html">Arduino IDE</a></li>
                            
                            
                            
                            <li><a href="mydoc_getstart_mbed.html">mbed-OS</a></li>
                            
                            
                            
                            <li><a href="mydoc_getstart_mynewt.html">Apache Mynewt-OS</a></li>
                            
                            
                            
                            <li><a href="mydoc_getstart_zephyr.html">Zephyr</a></li>
                            
                            
                            
                            <li><a href="mydoc_getstart_riot.html">RIOT-OS</a></li>
                            
                            
                            
                            <li><a href="mydoc_getstart_nordicsdk.html">Nordic SDK</a></li>
                            
                            
                        </ul>
                    </li>
                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Feedback<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                            
                            <li><a href="https://github.com/VNGIoTLab/vbluno/issues" target="_blank">Github issues tracker</a></li>
                            
                            
                            
                            <li><a href="https://www.facebook.com/bleviet/messages" target="_blank">Send Facebook messages</a></li>
                            
                            
                        </ul>
                    </li>
                    
                    
                    <li><a class="link-vi" href="/vbluno/vi/index_vi.html">TIẾNG VIỆT</a></li>
                    <!-- for test in local -->
                    <!-- <li><a class="link-vi" href="/vi/index_vi.html">TIẾNG VIỆT</a></li>	-->

                
                

                <!--comment out this block if you want to hide search-->
                <li>
                
                    <!--start search-->
                    <div id="search-demo-container">                    
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>

                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Introduction to Bluetooth Low Energy technology">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                

                </li>                
            </ul>    

        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">VBLUno51 board </li>
    
    
            
        
    
    <li>
        <a href="#">Overview</a>
        <ul>
            

            

            
            
            
            <li><a href="mydoc_introduction.html">Introduction</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_over_hardware.html">Note about the hardware versions (important)</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_over_sdk.html">Software Development Kit</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_over_appcanmake.html">What applications can you make by the VBLUno51?</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Documents</a>
        <ul>
            

            

            
            
            
            <li><a href="https://goo.gl/HUdV1Q" target="_blank">Nordic nRF51822 specification</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_doc_hardware.html">Schematic and PCB</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_doc_pinout.html">Pinout</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_doc_fritzing.html">Fritzing Part</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_doc_daplink.html">Upgrade DAPLink firmware</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://goo.gl/oVdvcv" target="_blank">mbed Serial driver (Only Windows)</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Getting Started</a>
        <ul>
            

            

            
            
            
            <li><a href="mydoc_getstart_arduino.html">Using Arduino IDE</a></li>
            
            
            
            
            <li class="subfolders">
                <a href="#">Using mbed-OS</a>
                <ul>
                    
                    
                    
                    <li><a href="mydoc_getstart_mbedonline.html">mbed Online Compiler</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_getstart_gnuarm_eclipse.html">GNU ARM Embedded & Eclipse IDE (recommend)</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_getstart_keil.html">Keil uVision</a></li>
                    
                    
                    
                </ul>
            </li>
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Bluetooth Low Energy (BLE)</a>
        <ul>
            

            

            
            
            
            <li class="active"><a href="mydoc_ble.html">Introduction to Bluetooth Low Energy</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://goo.gl/5q7jC4" target="_blank">BLE manual for mbed-OS</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Tutorials</a>
        <ul>
            
            
            <li class="subfolders">
                <a href="#">Adruino</a>
                <ul>
                    
                    
                    
                    <li><a href="mydoc_arduino_tut1.html">Tut1 - Heart rate monitor device (HRM) with VBLUno51</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_arduino_tut2.html">Tut2 - iBeacons device with VBLUno51</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_arduino_tut3.html">Tut3 - Measure the temperature inside nRF51822 (SoC)</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_arduino_tut4.html">Tut4 - Health thermometer with VBLUno (HTM)</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_arduino_tut5.html">Tut5 - Communicate between smartphone and PC by “UART over BLE”</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_arduino_tut6.html">Tut6 - Controlling/monitoring a device by Smartphone over BLE</a></li>
                    
                    
                    
                </ul>
            </li>
            
            

            
            
            <li class="subfolders">
                <a href="#">mbed-OS</a>
                <ul>
                    
                    
                    
                    <li><a href="mydoc_mbed_tut1.html">Tut1 - Program/debug for VBLUno by pyOCD and OpenOCD on GNU ARM Embedded + Eclipse</a></li>
                    
                    
                    
                    
                    
                    <li><a href="mydoc_mbed_tut2.html">Tut2 - BLE Beacons</a></li>
                    
                    
                    
                </ul>
            </li>
            
            

            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Code Examples</a>
        <ul>
            

            

            
            
            
            <li><a href="mydoc_code_arduino.html">Arduino</a></li>
            
            
            

            


            
            
            
            
            <li><a href="mydoc_code_mbed.html">mbed-OS</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Video</a>
        <ul>
            

            

            
            
            
            <li><a href="https://goo.gl/Vi0mpo" target="_blank">BLE Serial application</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://goo.gl/01X4oM" target="_blank">Controlling a robot over BLE with VBLUno</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Mobile applications for BLE</a>
        <ul>
            

            

            
            
            
            <li><a href="https://goo.gl/i6DNtP" target="_blank">iBeacon & Eddystone Scanner (Android)</a></li>
            
            
            
            
            <li class="subfolders">
                <a href="#">Nordic nRF Toolbox</a>
                <ul>
                    
                    
                    
                    <li><a href="https://goo.gl/s3fbVW" target="_blank">Android</a></li>
                    
                    
                    
                    
                    
                    <li><a href="https://goo.gl/GH8gom" target="_blank">iOS</a></li>
                    
                    
                    
                </ul>
            </li>
            
            

            


            
            
            
            
            <li><a href="https://goo.gl/sFbubD" target="_blank">nRF UART 2.0 (Android)</a></li>
            
            
            
            
            <li class="subfolders">
                <a href="#">Open source softwares</a>
                <ul>
                    
                    
                    
                    <li><a href="https://goo.gl/Et1atP" target="_blank">Nordic nRFToolbox (Android)</a></li>
                    
                    
                    
                    
                    
                    <li><a href="https://goo.gl/rdTll8" target="_blank">BluetoohLeGatt Example (Android)</a></li>
                    
                    
                    
                </ul>
            </li>
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">Links</a>
        <ul>
            

            

            
            
            
            <li><a href="http://iotviet.com.vn" target="_blank">IoT Vietnam Store</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://goo.gl/YCxUeK" target="_blank">CSM Router (VNG)</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://zalopay.vn" target="_blank">ZaloPay – (Auto payment application)</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://www.facebook.com/groups/iotalliancevn/" target="_blank">Vietnam IoT Alliance page</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://developer.mbed.org/" target="_blank">ARM mbed  OS developer site</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
    
    <li>
        <a href="#">About</a>
        <ul>
            

            

            
            
            
            <li><a href="https://goo.gl/c3sbnk" target="_blank">Contact our store</a></li>
            
            
            

            


            
            
            
            
            <li><a href="https://www.facebook.com/bleviet/" target="_blank">Bluetooth Low Energy – BLE Vietnam page</a></li>
            
            
            

            


            
            
        </ul>
    </li>
                
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->    
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Introduction to Bluetooth Low Energy technology</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->



	<script>
	$( document ).ready(function() {
	  // Handler for .ready() called.

	$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

	/* this offset helps account for the space taken up by the floating toolbar. */
	$('#toc').on('click', 'a', function() {
	  var target = $(this.getAttribute('href'))
	    , scroll_target = target.offset().top

	  $(window).scrollTop(scroll_target - 10);
	  return false
	})
	  
	});
	</script>

	<div id="toc"></div>



    


    

  <hr />
<h2 id="introduce-bluetooth-low-energy-technology">Introduce Bluetooth Low Energy Technology</h2>

<ul>
  <li>
    <p>Firstly, BLE is not all, it does not replace completely other wireless communication standards like Wifi, Zigbee, … or even Bluetooth Classic (2.0). It is designed for a more specialized purpose, with a more specific application domain.</p>
  </li>
  <li>
    <p>BLE (Bluetooth 4.0 up) is designed for applications:</p>

    <p>+Super energy saving, allowing device active for months or years with just one coin-cell battery;</p>

    <ul>
      <li>
        <p>Short distance, stable operation within 10m;</p>
      </li>
      <li>
        <p>Data trafic is not large, suitable for discrete control applications, sensors.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Typical applications use BLE as health monitoring devices, beacons, smart houses, security, entertainment, proximity sensors, automobiles. The centerpiece of a BLE application system is usually smart phones, tablets and PCs.</p>
  </li>
</ul>

<h3 id="history-of-bluetooth-technology-development">History of Bluetooth technology development</h3>

<p><img src="images/ble/introduce/eng0.png" alt="" /></p>

<p>VNGIoTLab’s VBLUno51 boards use the Nordic nRF51822 chip, which currently supports the Bluetooth Standard 4.2.</p>

<h3 id="what-makes-ble-become-different">What makes BLE become different?</h3>

<ul>
  <li>
    <p>The rapid development of devices led to a sharp increase in the demand of connection between smart devices  to external devices. While BLE is integrated in most smartphones.</p>
  </li>
  <li>
    <p>Low cost.</p>
  </li>
  <li>
    <p>BLE allows devices can “talk” to modern mobile platforms.</p>
  </li>
  <li>
    <p>Some devices only need to transmit a small amount of data for each cycle connection and they also need energy savings, such as heart rate monitor, child management devices, etc.</p>
  </li>
  <li>
    <p>BLE has a relatively easy-to-understand data model, without the cost of a license with a protocol stack is not too complex.</p>
  </li>
</ul>

<h3 id="types-of-bluetooth-devices">Types of Bluetooth devices.</h3>

<ul>
  <li>The Bluetooth Specification (4.0 onwards) defines the following two wireless technologies:
    <ul>
      <li>BR / EDR (Classic Bluetooth)</li>
      <li>BLE (Bluetooth Low Energy)</li>
    </ul>
  </li>
</ul>

<p>The most common types of Bluetooth devices today are outlined below:</p>

<p><img src="images/ble/introduce/1.png" alt="" /></p>

<p>As the picture above, the BLE device consists of two types: Bluetooth Smart and Bluetooth Smart Ready.</p>

<ul>
  <li>
    <p>Bluetooth Smart (Single mode): Only communicate with Bluetooth Smart or Bluetooth Smart Ready</p>
  </li>
  <li>
    <p>Bluetooth Smart Ready (Dual mode): It can communicate with Bluetooth devices such as Bluetooth Smart, Bluetooth Smart Ready and Classic Bluetooth.</p>
  </li>
  <li>
    <p>nRF51822 chip is Bluetooth Smart.</p>
  </li>
</ul>

<h3 id="main-blocks-of-a-bluetooth-device">Main blocks of a Bluetooth device</h3>

<ul>
  <li>
    <p>Each Bluetooth device consists of three main blocks:</p>

    <ul>
      <li>
        <p>Application: The user application communicates with Bluetooth protocol stack.</p>
      </li>
      <li>
        <p>Host: The upper layer of the Bluetooth protocol stack.</p>
      </li>
      <li>
        <p>Controller: The under layer of the Bluetooth protocol stack, including radio transmitter functionality.</p>
      </li>
    </ul>
  </li>
</ul>

<p><em>(Bluetooth Protocol Stack: The stack protocol allows Bluetooth devices to establish, connect, and transmit data.)</em></p>

<p>Three main blocks of a Bluetooth device are integrated into the hardware in a variety of different styles, here are three main types of hardware configurations:</p>

<p><img src="images/ble/introduce/2.png" alt="" /></p>

<p>Nordic nRF51822 chip is a System on Chip (SoC), Bluetooth components integrated in a single chip.</p>

<h3 id="main-limitations-of-ble">Main limitations of BLE</h3>

<p><strong>- Small data throughput:</strong></p>

<p>Frequency modulation of BLE waves in space is 1Mbps. This is the upper limit of theoretical throughput. However, in reality this parameter is smaller due to the influence of many factors.</p>

<p>To illustrate, we assume that a master device is initialized and connected to a slave via the BLE interface:</p>

<ul>
  <li>
    <p>We have a concept of connection cycles (Conneciton interval), this is the time between two consecutive connection events. With BLE, when a connection event occurs, the devices in the connection exchange the data together, then return to the IDLE state to save energy, and wait until the time to perform next connection event. This parameter is from 7.5ms to 4s.</p>
  </li>
  <li>
    <p>nRF51822 can transmit up to 6 packets per connection event. Each package can contain 20 bytes.</p>
  </li>
  <li>
    <p>Assuming the connection event frequency is the largest (minimum connection cycle = 7.5ms). At that moment, up to 133 connection events can occur per second</p>
  </li>
</ul>

<p>–&gt; Throughput calculation formula: 133 * 120 = 15960 bytes / sec (125Kbit / s)</p>

<p><em>Recommended we should choose throughput of about 80 Kbit/s. This also tells why Wifi, classic bluetooth still have a place.</em></p>

<p><strong>- Close distance</strong></p>

<p>Factors affecting to distance of communication such as operating environment, antenna design, obstruction, device orientation, etc. BLE focuses on communication applications in close distance.</p>

<ul>
  <li>
    <p>With BLE we have:</p>

    <ul>
      <li>
        <p>Theoretical distance: 100m (good condition).</p>
      </li>
      <li>
        <p>Possible distance: 30m.</p>
      </li>
      <li>
        <p>Distance usually used: 2-5m.</p>
      </li>
    </ul>
  </li>
</ul>

<hr />
<h2 id="network-communication-model-for-ble">Network communication model for BLE</h2>

<p>A BLE device can communicate with the outside through two mechanisms: Broadcasting or Connection. Each mechanism has its own advantages and limitations, both set by Generic Access Profile (GAP)</p>

<h3 id="broadcasting-và-observing">Broadcasting và Observing</h3>

<p><img src="images/ble/introduce/3.png" alt="" /></p>

<ul>
  <li>
    <p>Broadcaster Devices: Sends broadcast packets that are connectionless to any device that can receive them.</p>
  </li>
  <li>
    <p>Observer Devices: Scans continuously at set frequencies to receive connectionless broadcast packets.</p>
  </li>
</ul>

<p>This is the type of communication that allows a device to transmit data to multiple devices at one time. This is a fast and easy-to-use mechanism, which is a good option if you want to transfer small amounts of data to multiple devices at the same time. The restriction is that data is not secure, so it is not suitable for transmitting sensitive data.</p>

<h3 id="connection">Connection</h3>

<p><img src="images/ble/introduce/4.png" alt="" /></p>

<ul>
  <li>
    <p>Central (Master) Device: Scans broadcast packets for connection at set frequencies, when come to appropriate time it will initiates a connection with a peripheral. Central manages timing and initiates cyclical data exchanges.</p>
  </li>
  <li>
    <p>Peripheral device (Slave): Broadcast periodic connection-oriented broadcasts and accept connections requested by central.</p>
  </li>
  <li>
    <p>Connection Initialization:</p>

    <ul>
      <li>
        <p>When you want to connect, slave broadcasts packets broadcast to space.</p>
      </li>
      <li>
        <p>Central receives the broadcast packets of slave, which contains the necessary information to allow connection to the slave.</p>
      </li>
      <li>
        <p>Based on that, central sends a request to connect to slave then establish a separate connection between two devices.</p>
      </li>
      <li>
        <p>When the connection is established, slave stops broadcasting and two devices can begin to exchange two-way data. Master and slave roles do not affect data transfer, though Master is the connection manager.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>The advantage of Connection over Broadcasting is:</p>

    <ul>
      <li>
        <p>High bandwidth.</p>
      </li>
      <li>
        <p>The ability to establish secure link-link.</p>
      </li>
      <li>
        <p>Optimal energy management.</p>
      </li>
      <li>
        <p>The ability to organize data with multiple conformational changes for attributes through using additional protocol layers, particularly Generic Attribute Profile (GATT). Data is organized in a structured sense around what are called services and characteristics.</p>
      </li>
    </ul>
  </li>
</ul>

<hr />
<h2 id="protocols-and-profiles">Protocols and Profiles</h2>

<p>In order two devices can communicate with each other through the BLE standard, BLE devices need to comply with some regulations. These rules are generalized into protocols and configurations.</p>

<ul>
  <li>
    <p><strong>Protocol:</strong> A set of rules that govern formatting of packets, routing, multiplexing, encryption, etc. to exchange data between sides.</p>
  </li>
  <li>
    <p><strong>Profile:</strong> Defining how the protocol is used to achieve specific objectives. There are two types of configurations: generic profiles and use-case profiles.</p>

    <ul>
      <li>
        <p><em>Generic profiles:</em> Base profiles are defined in the Bluetooth Specifications, especially two profiles that are indispensable for BLE devices to connect and exchange data with each other, GAP and GATT.</p>
      </li>
      <li>
        <p><em>Use-case profile:</em> Profiles for specific use cases</p>

        <ul>
          <li>
            <p>Profiles which are defined by Bluetooth Special Interest Group (SIG)</p>
          </li>
          <li>
            <p>Profiles are defined  manually by vendor.</p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />
<h2 id="the-ble-protocols-stack">The BLE Protocols Stack</h2>

<p>To program BLE devices, it’s possible to just care about API functions in the upper layer of the BLE protocol stack, but it’s better to start with a basic view of interface. This gives BLE, which provides background knowledge to further research into BLE.</p>

<p>The figure below shows the full list of components within BLE suite for the Bluetooth Smart device.</p>

<p><img src="images/ble/introduce/5.png" alt="" /></p>

<ul>
  <li>
    <p>The protocol suite for BLE devices is divided into three main parts: controller, host and application. Each section consists of one or more layers according to function:</p>

    <ul>
      <li>
        <p>Application: The highest layer of protocols suite, providing a user interface, logical processing, and data control of everything related to the application’s operating instances. The architecture of application depends on specific problem.</p>
      </li>
      <li>
        <p>Host: includes the following classes</p>

        <ul>
          <li>
            <p>Generic Access Profile (GAP)</p>
          </li>
          <li>
            <p>Generic Attribute Profile (GATT)</p>
          </li>
          <li>
            <p>Attribute Protocol (ATT)</p>
          </li>
          <li>
            <p>Security Manager (SM)</p>
          </li>
          <li>
            <p>Logical Link Control and Adaptation Protocol (L2CAP)</p>
          </li>
          <li>
            <p>Host Controller Interface (HCI), Host side</p>
          </li>
        </ul>
      </li>
      <li>
        <p>Controller: includes the following classes</p>

        <ul>
          <li>
            <p>Host Controller Interface (HCI), Controller side</p>
          </li>
          <li>
            <p>Link Layer (LL)</p>
          </li>
          <li>
            <p>Physical Layer (PHY)</p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>Table summarizes the functions of classes in stack</p>

<p><img src="images/ble/introduce/eng6.png" alt="" /></p>

<p><img src="images/ble/introduce/eng7.png" alt="" /></p>

<p><img src="images/ble/introduce/eng8.png" alt="" /></p>

<p>In conclution, BLE protocol stack include multiple layers, each layer performs certain functions that facilitate communication between BLE devices.</p>

<hr />
<h2 id="base-profiles-gap-and-gatt">Base profiles: GAP and GATT</h2>

<h3 id="gap-advertising-and-connections">GAP (Advertising and Connections)</h3>

<ul>
  <li>
    <p>GAP (Generic Access Profile) is the platform that allows BLE devices to communicate with each other. It provides a framework that any BLE devices must follow to be able to search for other Bluetooth (BLE) devices, broadcast data, establish a secure connection, perform a variety of platform activities under A standard</p>
  </li>
  <li>
    <p>The BLE Specifications document defines the following concepts when considering interactions between devices:</p>

    <ul>
      <li>
        <p>Roles: Each device can operate in one or more different roles at the same time: broadcaster, observer, central, peripheral.</p>
      </li>
      <li>
        <p>Modes: A mode is a state in which the device can be moved for a period of time to achieve a specific purpose or special thing, to allow a peer to perform a particular procedure.</p>
      </li>
      <li>
        <p>Procedures: The procedures (usually the link layer that controls the exchange of packets) to allow a device to achieve a certain purpose. A procedure is usually associated with a mode, so mode and procedure are often considered together.</p>
      </li>
      <li>
        <p>Security: GAP builds on Security Manager and Security Manager Protocol (which defines security modes and procedures to determine how devices set security levels when exchanging data). In addition, GAP defines more advanced security features without being associated with specific modes and procedures, enhancing the level of data protection required by each application.</p>
      </li>
    </ul>
  </li>
</ul>

<p><img src="images/ble/introduce/9.png" alt="" /></p>

<p><img src="images/ble/introduce/10.png" alt="" /></p>

<p>GAP is the highest control layer of BLE (Highest Control layer) and is mandatory for all BLE devices.</p>

<h3 id="gatt-services-and-characteristics">GATT (Services and Characteristics)</h3>

<ul>
  <li>
    <p>GATT set details how to exchange all profiles and user data over a BLE connection. In contrast to GAP (which defines low-level interactions with devices), GATT only demonstrates actual data transmission and formatting procedures.</p>
  </li>
  <li>
    <p>GATT uses ATT and its transmission protocols to exchange data between devices. This data is organized hierarchically into sections called services, which group related conceptual pieces of user data called characteristic. In short, the data transmitted through BLE is structured data, which in particular is organized into services and characteristics.</p>
  </li>
</ul>

<p><strong>Roles</strong></p>

<ul>
  <li>
    <p>GATT Client: corresponds to the ATT client, sends the request to the server and receives the response. Initially, the GATT Client did not know what attributes server was supporting so it needed to perform service discovery.</p>
  </li>
  <li>
    <p>GATT Server: corresponds to the ATT server, receives request from the client, and sends the corresponding content.</p>
  </li>
  <li>
    <p>Note that GATT roles do not depend on the role of GAP. This means that both GAP Central and GAP Peripheral can act as GATT Client or GATT Server or even both at the same time.</p>
  </li>
</ul>

<p><strong>UUIDs</strong></p>

<ul>
  <li>UUIDs is a unique 128-bit (16 byte) device identifier in the world. Because the length is too large, BLE Specification defines two more UUIDs: 16bit and 32bit. These short formats may only be used with the UUID defined in the BT Specification.</li>
</ul>

<p><strong>Attributes</strong></p>

<ul>
  <li>
    <p>Attributes is the smallest data which defined entity by GATT (and ATT).</p>
  </li>
  <li>
    <p>Both GATT and ATT work only with attributes, so for all client and server interactions all data must be organized in this format.</p>
  </li>
  <li>
    <p>Each attribute contains information about itself that is user data and is described as follows:</p>

    <ul>
      <li>
        <p>Handle: The only 16 bits per server to address the attribute</p>
      </li>
      <li>
        <p>Type: UUID type, 16bit - 32bit - 128 bit</p>
      </li>
      <li>
        <p>Permission: specifies the ATT opertation that can be executed on a particular attribute</p>
      </li>
      <li>
        <p>Value: Contains the actual data portion of the attribute, 512 byte limit</p>
      </li>
    </ul>
  </li>
</ul>

<p><strong>Services and Characteristics</strong></p>

<p>Data exchanged via a BLE connection is structured data, organized hierarchically into services, services themselves including characteristics.</p>

<p><img src="images/ble/introduce/11.png" alt="" /></p>

<hr />
<h2 id="profiles-for-each-specific-application">Profiles for each specific application</h2>

<p>GAP and GATT are two platform profiles for every BLE applications. In addition, depending on the applications, devices will provide other profiles (based on GAP and GATT). The main services are the services provided by the device such as: Heart Rate Monitor, Battery, Health Thermometer, HID, …</p>

<p>For detailed information about services, visit the following links:</p>

<p>https://www.bluetooth.com/specifications/adopted-specifications https://www.bluetooth.com/specifications/gatt/services.</p>

<p>These links above represent profiles that have been defined by the Bluetooth SIG organization. In addition, device manufacturers can define more profiles themselves.</p>

<hr />
<h2 id="example-illustrating-heart-rate-monitor-hrm-with-the-vbluno51-board-on-arduino">Example illustrating heart rate monitor (HRM) with the VBLUno51 board on Arduino</h2>

<ul>
  <li>Heart Rate Monitor– HRM</li>
</ul>

<p>The figure below shows the structure of the Heart Rate Service (HRS)</p>

<p><img src="images/ble/introduce/12.png" alt="" /></p>

<ul>
  <li>We can see, HRS consists of two characteristics that provide information about the heart rate and the location of the sensor on the body. Details can be found at the following link:</li>
</ul>

<p>https://www.bluetooth.com/specifications/gatt/viewer?attributeXmlFile=org.blueooth.service.heart_rate.xml</p>

<ul>
  <li>
    <p>The following example illustrates a BLE device that measures heart rate and transmits to BLE Central (Smartphones, tablets, PC). Since there are no sensors that support this feature, in this example we just create a dummy signal as described below:</p>

    <ul>
      <li>
        <p>The heart rate value varies linearly from 100 to 175 with an increase of 1</p>
      </li>
      <li>
        <p>Position sensor on body: Finger (code = 0x03)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Perform:</p>

    <ul>
      <li>
        <p>Open the HRM example: File =&gt; Examples =&gt; BLE_Examples =&gt; BLE_HRM</p>
      </li>
      <li>
        <p>Compile and upload to VBLUno board. If successful you already have a BLE device that illustrates the heart rate monitor feature.</p>
      </li>
      <li>
        <p>To connect to this device, you need a BLE Central (Smart phone, tablet, PC). Here we use Nordic’s nRF Toolbox software and BLE Tool software to illustrate.</p>
      </li>
    </ul>
  </li>
</ul>

<p><img src="images/ble/introduce/13.png" alt="" /></p>

<p>On Android phone or iPhone, run the nRF Toolbox, select the HRM entry, click Connect to search the HRM device, and request a connection.</p>

<p><img src="images/ble/introduce/14.png" alt="" /></p>

<p><img src="images/ble/introduce/15.png" alt="" /></p>

<p><img src="images/ble/introduce/16.png" alt="" /></p>

<p>The source code of the example program is quite simple, you can read it yourself and find out.</p>

<hr />
<h2 id="ble-introduction-book">BLE introduction book</h2>

<p>To find out more about BLE you can refer to some of the following materials:</p>

<ul>
  <li>
    <p>Getting started with Bluetooth Low Energy – Tool and techniques for low-power networking của Kevin Townsend, Carles Cufí, Akiba &amp; Robert Davidson.</p>
  </li>
  <li>
    <p>Bluetooth Low Energy – The developer’s handbook, Robin Heydon</p>
  </li>
</ul>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_ble.html" class="btn btn-default navbar-btn cursorNorm" role="button">ble</a>
        
        
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 VNG Corporation. All rights reserved. <br />
 Site last generated: Jun 15, 2017 <br />
<p><img src="images/company_logo_medium.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>